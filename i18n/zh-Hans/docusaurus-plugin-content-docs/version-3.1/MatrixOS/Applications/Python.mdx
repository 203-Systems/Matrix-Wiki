---
sidebar_position: 10
---

# Python 应用

Python 应用在魔矩设备上提供交互式 Python REPL（读取-求值-打印循环）环境。你可以实时编写和执行 Python 代码，控制 LED、响应按键，并通过 PikaPython 解释器访问所有 Matrix OS API。

:::warning 紧急退出
要退出 Python 应用，长按功能键（中心键）3 秒钟返回主屏幕。该紧急退出方式在所有应用中均可使用（系统级）。
:::

## 功能特性

- **交互式 Python REPL**：逐行编写和执行 Python 代码
- **Matrix OS API 访问**：控制 LED、读取键盘、发送 MIDI、使用 HID 功能
- **持久会话**：变量和函数在你的会话期间保持在内存中
- **实时反馈**：在设备上立即查看代码结果
- **教育工具**：非常适合学习 Python 和探索 Matrix OS 功能


## 入门指南

### 通过串口终端连接

要使用 Python REPL，你需要一个串口终端应用程序：

**Windows 用户：**
1. **下载 PuTTY**：从 [https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html](https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html) 获取 PuTTY

**macOS/Linux 用户：**
使用内置的 `screen` 命令或其他终端应用程序，如 `minicom`
2. **配置连接**：
然后（以 PuTTY 为例）：
1. **配置连接**：
   - 连接类型：串口
   - 串口：设备的 COM 端口（例如 COM3）
   - 速度：115200
2. **重要终端设置**：
   - Terminal → 勾选 "Implicit CR in every LF"（正确换行所必需）
3. **连接**：点击“打开”建立连接

### 基本使用

1. **进入 Python 应用**：从设备上的应用程序启动器中选择 Python
2. **开始编码**：REPL 将在你的串口终端中显示，准备接受 Python 命令
3. **执行代码**：输入 Python 语句并按 Enter 键查看即时结果
4. **退出**：使用 Python 函数 `exit()` 返回应用程序启动器，或长按中心键 3 秒钟强制退出

### 快速示例

#### LED 控制
```python
# 在位置 (3, 3) 以红色点亮 LED
MatrixOS.LED.SetColor(Point(3, 3), Color(255, 0, 0), 255)
MatrixOS.LED.Update(255)

# 用蓝色填充所有 LED
MatrixOS.LED.Fill(Color(0, 0, 255), 255)
MatrixOS.LED.Update(255)

# 清除所有 LED
MatrixOS.LED.Fill(Color(0, 0, 0), 0)
MatrixOS.LED.Update(0)
```

#### 键盘输入
```python
while True:
    event = MatrixOS.KeyPad.Get()
    if event != None and event.State() == MatrixOS.KeyState.PRESSED:
        print(f"在 ({event.xy.x}, {event.xy.y}) 处按下了按键")
```


## 可用 API

有关所有可用 Python API 的详细文档，请参阅 [Python 应用程序开发](../../Developer/PythonApplication)。